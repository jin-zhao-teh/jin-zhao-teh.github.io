<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project | Jin-Zhao Teh | Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      /* Dark Theme Base Styles */
      :root {
        --bg-dark: #121212;
        --bg-card: #1e1e1e;
        --bg-card-hover: #252525;
        --text-primary: #ffffff;
        --text-secondary: #b0b0b0;
        --text-muted: #888888;
        --accent: #4a6cf7;
        --accent-hover: #3a5ce5;
        --border: #333333;
        --separator: #444444;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        background-color: var(--bg-dark);
        color: var(--text-primary);
        font-family: 'Inter', sans-serif;
        line-height: 1.6;
        overflow: hidden;
      }
      
      /* Forced Loading Screen */
      .project-loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: flex-start;
      }
      
      .project-loading-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.6) 50%, rgba(0,0,0,0.4) 100%);
        z-index: -1;
      }
      
      .project-loading-background img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(0.7);
      }
      
      .project-loading-content {
        padding: 3rem;
        max-width: 600px;
        width: 100%;
      }
      
      .project-loading-info {
        margin-bottom: 2rem;
      }
      
      .project-loading-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }
      
      .project-loading-description {
        font-size: 1.2rem;
        color: var(--text-secondary);
        line-height: 1.6;
      }
      
      .separator {
        width: 80px;
        height: 2px;
        background-color: var(--separator);
        margin: 1.5rem 0;
      }
      
      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top: 4px solid var(--text-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 2rem 0;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .loading-progress {
        font-size: 1rem;
        color: var(--text-secondary);
        margin-top: 1rem;
      }
      
      /* Project Content (hidden during loading) */
      .project-content {
        display: none;
        padding: 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }
      
      .project-header {
        margin-bottom: 3rem;
        padding-top: 2rem;
      }
      
      .back-button {
        display: inline-flex;
        align-items: center;
        color: var(--text-secondary);
        text-decoration: none;
        margin-bottom: 2rem;
        transition: color 0.3s ease;
      }
      
      .back-button:hover {
        color: var(--text-primary);
      }
      
      .back-button i {
        margin-right: 0.5rem;
      }
      
      .project-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }
      
      .project-meta {
        display: flex;
        gap: 2rem;
        margin-bottom: 2rem;
        color: var(--text-secondary);
      }
      
      .project-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 2rem;
      }
      
      .project-tag {
        padding: 0.5rem 1rem;
        background-color: var(--bg-card);
        border-radius: 20px;
        font-size: 0.9rem;
        color: var(--text-secondary);
      }
      
      .project-description {
        font-size: 1.2rem;
        line-height: 1.7;
        color: var(--text-secondary);
        margin-bottom: 3rem;
        max-width: 800px;
      }
      
      .project-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 3rem;
      }
      
      .gallery-item {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
      
      .gallery-item img {
        width: 100%;
        height: 250px;
        object-fit: cover;
        display: block;
      }
      
      .project-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
      }
      
      .detail-card {
        background-color: var(--bg-card);
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      
      .detail-card h3 {
        margin-bottom: 1rem;
        color: var(--text-primary);
        font-size: 1.3rem;
      }
      
      .detail-card p {
        color: var(--text-secondary);
        line-height: 1.6;
      }
      
      .project-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border);
      }
      
      .nav-button {
        display: inline-flex;
        align-items: center;
        padding: 0.75rem 1.5rem;
        background-color: var(--bg-card);
        color: var(--text-primary);
        text-decoration: none;
        border-radius: 4px;
        transition: background-color 0.3s ease;
      }
      
      .nav-button:hover {
        background-color: var(--bg-card-hover);
      }
      
      .nav-button i {
        margin: 0 0.5rem;
      }
      
      /* Error State */
      .error-state {
        display: none;
        text-align: center;
        padding: 4rem 2rem;
      }
      
      .error-state i {
        font-size: 4rem;
        color: var(--text-muted);
        margin-bottom: 1.5rem;
      }
      
      .error-state h2 {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }
      
      .error-state p {
        color: var(--text-secondary);
        margin-bottom: 2rem;
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
      }
      
      .retry-button {
        display: inline-flex;
        align-items: center;
        padding: 0.75rem 1.5rem;
        background-color: var(--accent);
        color: var(--text-primary);
        border: none;
        border-radius: 4px;
        font-family: 'Inter', sans-serif;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      
      .retry-button:hover {
        background-color: var(--accent-hover);
      }
      
      .retry-button i {
        margin-right: 0.5rem;
      }
      
      /* Responsive adjustments */
      @media (max-width: 768px) {
        .project-loading-content {
          padding: 2rem;
        }
        
        .project-loading-title {
          font-size: 2.5rem;
        }
        
        .project-loading-description {
          font-size: 1.1rem;
        }
        
        .project-content {
          padding: 1rem;
        }
        
        .project-title {
          font-size: 2.5rem;
        }
        
        .project-meta {
          flex-direction: column;
          gap: 1rem;
        }
        
        .project-navigation {
          flex-direction: column;
          gap: 1rem;
        }
        
        .nav-button {
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <!-- Forced Loading Screen -->
    <div id="project-loading" class="project-loading">
      <div class="project-loading-background">
        <img src="https://jin-zhao-teh.github.io/Images/English.png" alt="Project Background" id="loading-bg">
      </div>
      <div class="project-loading-content">
        <div class="project-loading-info">
          <h1 class="project-loading-title" id="loading-title">Loading Project</h1>
          <div class="separator"></div>
          <p class="project-loading-description" id="loading-description">Preparing your project experience</p>
          <div class="separator"></div>
        </div>
        <div class="loading-spinner"></div>
        <div class="loading-progress" id="loading-progress">Loading... 0%</div>
      </div>
    </div>

    <!-- Error State -->
    <div id="error-state" class="error-state">
      <i class="fas fa-exclamation-triangle"></i>
      <h2>Project Not Found</h2>
      <p>We couldn't load the project you're looking for. It might have been moved or no longer exists.</p>
      <button class="retry-button" id="retry-button">
        <i class="fas fa-redo"></i>
        Try Again
      </button>
      <p style="margin-top: 2rem;">
        <a href="index.html" class="back-button">
          <i class="fas fa-arrow-left"></i>
          Back to Portfolio
        </a>
      </p>
    </div>

    <!-- Project Content -->
    <div id="project-content" class="project-content">
      <div class="project-header">
        <a href="index.html" class="back-button">
          <i class="fas fa-arrow-left"></i>
          Back to Portfolio
        </a>
        <h1 class="project-title" id="project-title">New Zealand Summer</h1>
        <div class="project-meta">
          <span><i class="far fa-calendar"></i> <span id="project-year">2025</span></span>
          <span><i class="far fa-clock"></i> <span id="project-duration">5 min read</span></span>
          <span><i class="fas fa-tag"></i> <span id="project-category">English, Writing</span></span>
        </div>
        <div class="project-tags" id="project-tags">
          <!-- Tags will be dynamically added here -->
        </div>
        <p class="project-description" id="project-description">
          A persuasive writing piece exploring the unique beauty of New Zealand's summer season, capturing the essence of its landscapes, culture, and atmosphere.
        </p>
      </div>

      <div class="project-gallery" id="project-gallery">
        <!-- Gallery items will be dynamically added here -->
      </div>

      <div class="project-details" id="project-details">
        <!-- Detail cards will be dynamically added here -->
      </div>

      <div class="project-full-content" id="project-full-content">
        <!-- Full content will be dynamically added here -->
      </div>

      <div class="project-navigation">
        <a href="#" class="nav-button" id="prev-project">
          <i class="fas fa-arrow-left"></i>
          Previous Project
        </a>
        <a href="index.html" class="nav-button">
          Back to Portfolio
          <i class="fas fa-arrow-right"></i>
        </a>
        <a href="#" class="nav-button" id="next-project">
          Next Project
          <i class="fas fa-arrow-right"></i>
        </a>
      </div>
    </div>

    <script>
      // Function to get URL parameters
      function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        const results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      }

      // Function to simulate loading progress
      function simulateProgress(callback) {
        let progress = 0;
        const progressInterval = setInterval(() => {
          progress += Math.random() * 15;
          if (progress > 100) progress = 100;
          
          document.getElementById('loading-progress').textContent = `Loading... ${Math.round(progress)}%`;
          
          if (progress >= 100) {
            clearInterval(progressInterval);
            if (callback) callback();
          }
        }, 300);
      }

      // Function to show error state
      function showErrorState() {
        document.getElementById('project-loading').style.display = 'none';
        document.getElementById('error-state').style.display = 'block';
        document.body.style.overflow = 'auto';
      }

      // Function to show project content
      function showProjectContent() {
        document.getElementById('project-loading').style.display = 'none';
        document.getElementById('project-content').style.display = 'block';
        document.body.style.overflow = 'auto';
      }

      // Function to render project data
      function renderProjectData(projectData) {
        // Set project content
        document.getElementById('project-title').textContent = projectData.title;
        document.getElementById('project-description').textContent = projectData.description;
        
        // Set meta information if available
        if (projectData.year) {
          document.getElementById('project-year').textContent = projectData.year;
        }
        
        if (projectData.duration) {
          document.getElementById('project-duration').textContent = projectData.duration;
        }
        
        if (projectData.category) {
          document.getElementById('project-category').textContent = projectData.category;
        }
        
        // Add tags to project page
        const tagsContainer = document.getElementById('project-tags');
        tagsContainer.innerHTML = '';
        
        if (projectData.tags && projectData.tags.length > 0) {
          projectData.tags.forEach(tag => {
            const tagElement = document.createElement('span');
            tagElement.className = 'project-tag';
            tagElement.textContent = tag;
            tagsContainer.appendChild(tagElement);
          });
        }
        
        // Add gallery images if available
        const galleryContainer = document.getElementById('project-gallery');
        galleryContainer.innerHTML = '';
        
        if (projectData.images && projectData.images.length > 0) {
          projectData.images.forEach(image => {
            const galleryItem = document.createElement('div');
            galleryItem.className = 'gallery-item';
            
            const img = document.createElement('img');
            img.src = image.src;
            img.alt = image.alt || projectData.title;
            
            galleryItem.appendChild(img);
            galleryContainer.appendChild(galleryItem);
          });
        }
        
        // Add detail cards if available
        const detailsContainer = document.getElementById('project-details');
        detailsContainer.innerHTML = '';
        
        if (projectData.details && projectData.details.length > 0) {
          projectData.details.forEach(detail => {
            const detailCard = document.createElement('div');
            detailCard.className = 'detail-card';
            
            const title = document.createElement('h3');
            title.textContent = detail.title;
            
            const content = document.createElement('p');
            content.textContent = detail.content;
            
            detailCard.appendChild(title);
            detailCard.appendChild(content);
            detailsContainer.appendChild(detailCard);
          });
        }
        
        // Add full content if available
        const fullContentContainer = document.getElementById('project-full-content');
        fullContentContainer.innerHTML = '';
        
        if (projectData.fullContent) {
          fullContentContainer.innerHTML = projectData.fullContent;
        }
        
        // Set up navigation if available
        if (projectData.prevProject) {
          document.getElementById('prev-project').href = projectData.prevProject;
        } else {
          document.getElementById('prev-project').style.display = 'none';
        }
        
        if (projectData.nextProject) {
          document.getElementById('next-project').href = projectData.nextProject;
        } else {
          document.getElementById('next-project').style.display = 'none';
        }
      }

      // Main function to load project data
      async function loadProjectData() {
        const projectId = getUrlParameter('id') || 'new-zealand-summer';
        
        try {
          // Fetch routes data
          const response = await fetch('https://jin-zhao-teh.github.io/router/routes.json');
          
          if (!response.ok) {
            throw new Error('Failed to fetch project data');
          }
          
          const routesData = await response.json();
          
          // Find the current project in the routes data
          // This assumes routes.json has a structure with projects array
          let projectData = null;
          
          if (routesData.projects && Array.isArray(routesData.projects)) {
            projectData = routesData.projects.find(project => 
              project.id === projectId || project.slug === projectId
            );
          }
          
          // If project not found, show error
          if (!projectData) {
            throw new Error('Project not found');
          }
          
          // Set loading screen content
          document.getElementById('loading-title').textContent = `Loading ${projectData.title}`;
          document.getElementById('loading-description').textContent = projectData.description;
          
          if (projectData.image) {
            document.getElementById('loading-bg').src = projectData.image;
          }
          
          // Start progress simulation
          simulateProgress(() => {
            // Force loading screen to show for at least 3 seconds
            setTimeout(() => {
              renderProjectData(projectData);
              showProjectContent();
            }, 3000); // 3 seconds minimum
          });
          
        } catch (error) {
          console.error('Error loading project:', error);
          
          // Set error state on loading screen
          document.getElementById('loading-title').textContent = 'Error Loading Project' + error;
          document.getElementById('loading-description').textContent = 'We encountered an issue while loading the project.';
          
          // Show error after a brief delay
          setTimeout(() => {
            showErrorState();
          }, 2000);
        }
      }

      // Initialize the page
      document.addEventListener('DOMContentLoaded', function() {
        // Set up retry button
        document.getElementById('retry-button').addEventListener('click', function() {
          document.getElementById('error-state').style.display = 'none';
          document.getElementById('project-loading').style.display = 'flex';
          document.body.style.overflow = 'hidden';
          loadProjectData();
        });
        
        // Load project data
        // loadProjectData();
      });
    </script>
  </body>
</html>
